schema: '2.0'
stages:
  prepare_split:
    cmd: python -m src.data.prepare_split
    deps:
    - path: src/data/prepare_split.py
      hash: md5
      md5: dd443eccf1b47fbf0b48c2db970aec32
      size: 879
    params:
      params.yaml:
        seed: 50
        split.test_percent: 1
        split.train_percent: 5
    outs:
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
  train_baseline:
    cmd: python -m experiments.train_baseline
    deps:
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: experiments/train_baseline.py
      hash: md5
      md5: 96b61863992d706a95efd46a23f94016
      size: 1890
    params:
      params.yaml:
        baseline.train.epochs: 10
        baseline.train.learning_rate: 0.001
        model.latent_channels: 128
        model.num_classes: 10
        model.pretrained: true
    outs:
    - path: checkpoints/baseline_model.pt
      hash: md5
      md5: dd4f10a6af3e3edd9f35b811fa1332e8
      size: 44806256
  evaluate@baseline:
    cmd: python -m experiments.evaluate --model_type baseline
    deps:
    - path: checkpoints/baseline_model.pt
      hash: md5
      md5: dd4f10a6af3e3edd9f35b811fa1332e8
      size: 44806256
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: experiments/evaluate.py
      hash: md5
      md5: 7ed1fa35c74cfad9cae1e8530686c9a8
      size: 4564
    params:
      params.yaml:
        model.latent_channels: 128
        model.num_classes: 10
    outs:
    - path: results/baseline_acc.json
      hash: md5
      md5: a1331e3950f4ee02b83e259019ddffd8
      size: 24
  pretrain_ae:
    cmd: python -m pretrain.ae_pretrain
    deps:
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: pretrain/ae_pretrain.py
      hash: md5
      md5: b72f450b9545e610ecf1158cf7cd9cc1
      size: 2176
    - path: src/models/ae.py
      hash: md5
      md5: 1419033b6ce4f8f48ad451226352c5da
      size: 2372
    params:
      params.yaml:
        ae.freeze: false
        ae.pretrain.epochs: 10
        ae.pretrain.learning_rate: 0.001
        ae.recon_loss_weight: 0.5
        model.latent_channels: 128
    outs:
    - path: checkpoints/ae_pretrained.pth
      hash: md5
      md5: 11ad48c6d15d051581042d3ed36acff1
      size: 599064
  train_ae:
    cmd: python -m experiments.train_ae_on_pooling
    deps:
    - path: checkpoints/ae_pretrained.pth
      hash: md5
      md5: 11ad48c6d15d051581042d3ed36acff1
      size: 599064
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: experiments/train_ae_on_pooling.py
      hash: md5
      md5: 4f855e27f8aad3ceb6948cdee7f813d3
      size: 3129
    - path: src/models/ae.py
      hash: md5
      md5: 1419033b6ce4f8f48ad451226352c5da
      size: 2372
    params:
      params.yaml:
        ae.freeze: false
        ae.recon_loss_weight: 0.5
        ae.train.cls_loss_weight: 1.0
        ae.train.epochs: 10
        ae.train.learning_rate: 0.001
        model.latent_channels: 128
        model.num_classes: 10
    outs:
    - path: checkpoints/ae_model.pt
      hash: md5
      md5: c93814af47201dc1a51d5d172bc64dea
      size: 45404142
  pretrain_vae:
    cmd: python -m pretrain.vae_pretrain
    deps:
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: pretrain/vae_pretrain.py
      hash: md5
      md5: 1c78c2dc38cfc4d67428ecd41115ef9a
      size: 2667
    - path: src/models/vae.py
      hash: md5
      md5: 61d38fd4eb06e8d75bb4f38257219f97
      size: 9981
    params:
      params.yaml:
        vae.beta: 10.0
        vae.hidden_ch: 256
        vae.latent_ch: 128
        vae.pretrain.epochs: 10
        vae.pretrain.learning_rate: 0.0001
    outs:
    - path: checkpoints/vae_pretrained.pth
      hash: md5
      md5: 46c82b8f57bd0186419b0045db1c68b3
      size: 22062374
  train_vae:
    cmd: python -m experiments.train_vae_on_pooling
    deps:
    - path: checkpoints/vae_pretrained.pth
      hash: md5
      md5: 46c82b8f57bd0186419b0045db1c68b3
      size: 22062374
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: experiments/train_vae_on_pooling.py
      hash: md5
      md5: a2935edf4e424128203ed91c53cb3e47
      size: 3365
    - path: src/models/vae.py
      hash: md5
      md5: 61d38fd4eb06e8d75bb4f38257219f97
      size: 9981
    params:
      params.yaml:
        vae.beta: 10.0
        vae.hidden_ch: 256
        vae.latent_ch: 128
        vae.train.cls_loss_weight: 5
        vae.train.epochs: 10
        vae.train.learning_rate: 0.0001
        vae.train.weight_decay: 1e-06
    outs:
    - path: checkpoints/vae_model.pt
      hash: md5
      md5: 4c4c8f99fa4b26b322599ea52fdda2f5
      size: 66867962
  evaluate@vae:
    cmd: python -m experiments.evaluate --model_type vae
    deps:
    - path: checkpoints/vae_model.pt
      hash: md5
      md5: 4c4c8f99fa4b26b322599ea52fdda2f5
      size: 66867962
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: experiments/evaluate.py
      hash: md5
      md5: 7ed1fa35c74cfad9cae1e8530686c9a8
      size: 4564
    params:
      params.yaml:
        model.latent_channels: 128
        model.num_classes: 10
    outs:
    - path: results/vae_acc.json
      hash: md5
      md5: df949ca8f696e10709febabad6e33673
      size: 24
  evaluate@ae:
    cmd: python -m experiments.evaluate --model_type ae
    deps:
    - path: checkpoints/ae_model.pt
      hash: md5
      md5: c93814af47201dc1a51d5d172bc64dea
      size: 45404142
    - path: data/cifar_split.npz
      hash: md5
      md5: ecb5fbb795ca1bd175c91a0f3593e49f
      size: 10920
    - path: experiments/evaluate.py
      hash: md5
      md5: 7ed1fa35c74cfad9cae1e8530686c9a8
      size: 4564
    params:
      params.yaml:
        model.latent_channels: 128
        model.num_classes: 10
    outs:
    - path: results/ae_acc.json
      hash: md5
      md5: 03846d9e2cba6018421dbb18fab1fefd
      size: 24
